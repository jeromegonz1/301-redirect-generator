# US009 - Matching IA SÃ©mantique

## ğŸ“‹ Contexte
Le matching ligne-par-ligne atteint ses limites face aux refontes avec structures diffÃ©rentes et dÃ©sÃ©quilibres d'URLs (800 anciennes vs 549 nouvelles).

## ğŸ¯ User Story

**En tant que** chef de projet digital,  
**je veux** que l'outil associe chaque ancienne URL Ã  la nouvelle URL la plus proche sÃ©mantiquement en utilisant une IA,  
**afin de** gagner du temps en cas de structure ou wording diffÃ©rent entre ancien et nouveau site.

## âœ… CritÃ¨res d'acceptation

### FonctionnalitÃ©s core
- [ ] Utilisation de GPT-3.5-turbo pour le matching sÃ©mantique
- [ ] Analyse du sens et du contenu de chaque URL (pas seulement les mots-clÃ©s)
- [ ] Score de confidence pour chaque correspondance (0.0 Ã  1.0)
- [ ] Rejection automatique des correspondances avec confidence < 0.7

### Interface utilisateur
- [ ] Checkbox "Activer le matching IA" dans l'interface
- [ ] Affichage des correspondances suggÃ©rÃ©es avec scores de confidence
- [ ] Code couleur : Vert (>0.9), Orange (0.7-0.9), Rouge (<0.7)

### Performance et fiabilitÃ©
- [ ] Chunking pour traiter 1000+ URLs (50 URLs par batch)
- [ ] Gestion des erreurs avec retry et fallback
- [ ] Timeout de 30 secondes par chunk
- [ ] ParallÃ©lisation limitÃ©e Ã  3 requÃªtes simultanÃ©es

### QualitÃ© du matching
- [ ] Taux de matching > 80% avec confidence > 0.7
- [ ] Correspondance 1:1 (une ancienne URL = une nouvelle URL maximum)
- [ ] URLs non matchÃ©es clairement identifiÃ©es

## ğŸ”§ SpÃ©cifications techniques

### API Configuration
```python
MODEL = "gpt-3.5-turbo"
TEMPERATURE = 0.1  # PrÃ©cision maximale
MAX_TOKENS = 4000
CHUNK_SIZE = 50
MAX_RETRIES = 3
```

### Format de rÃ©ponse IA
```json
{
    "correspondances": [
        {
            "ancienne": "https://site.com/camping-presentation-gard",
            "nouvelle": "/presentation",
            "confidence": 0.95,
            "raison": "Correspondance Ã©vidente : prÃ©sentation du camping"
        }
    ],
    "non_matchees": ["https://site.com/page-obsolete"]
}
```

## ğŸ§ª ScÃ©narios de test

### Test 1: Matching Ã©vident
```
EntrÃ©e:
- Ancien: /camping-presentation-gard
- Nouveau: /presentation
Attendu: confidence > 0.9
```

### Test 2: Wording diffÃ©rent
```
EntrÃ©e:
- Ancien: /mobil-home-luxe  
- Nouveau: /nos-locatifs
Contexte: "mobil-home devient nos locatifs"
Attendu: confidence > 0.8
```

### Test 3: Pas de correspondance
```
EntrÃ©e:
- Ancien: /page-obsolete-2019
- Nouveau: [aucune page similaire]
Attendu: Non matchÃ© (confidence < 0.7)
```

## ğŸ“Š MÃ©triques de succÃ¨s

- **PrÃ©cision** : 90% des suggestions avec confidence > 0.8 sont validÃ©es par l'utilisateur
- **Couverture** : 80% des anciennes URLs obtiennent une suggestion
- **Performance** : < 2 minutes pour traiter 1000 URLs
- **CoÃ»t** : < 5â‚¬ de coÃ»t API pour 1000 URLs

## ğŸš« Exclusions

- Matching entre langues diffÃ©rentes (gÃ©rÃ© par US012)
- Interface de validation manuelle (gÃ©rÃ© par US010)
- Prompt contextuel du chef de projet (gÃ©rÃ© par US014)

## ğŸ”„ Statut
**ğŸ”„ Ã€ dÃ©velopper** - PrÃªt pour implÃ©mentation aprÃ¨s validation des specs techniques

---

*US009 dÃ©veloppÃ©e pour SEPTEO Digital Services*  
*Matching IA sÃ©mantique avec GPT-3.5-turbo*